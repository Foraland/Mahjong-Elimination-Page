System.register("chunks:///_virtual/ApiManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./http.ts","./BaseManager.ts","./str.ts","./app.ts","./Config2.ts","./Defer2.ts"],(function(e){var s,n,t,r,i,o,a,u,c,f,p,d;return{setters:[function(e){s=e.inheritsLoose,n=e.asyncToGenerator},function(e){t=e.cclegacy,r=e._decorator},function(e){i=e.HttpConfig,o=e.Http},function(e){a=e.default},function(e){u=e.str_utils},function(e){c=e.app},function(e){f=e.gameId,p=e.version},function(e){d=e.Defer}],execute:function(){var l;t._RF.push({},"07311aMx3NBC4uwf4moIPuP","ApiManager",void 0);var g=r.ccclass,h=(r.property,["upLog","getSettings","getWsUrl","login","register"]),m="user";e("ApiManager",g("ApiManager")(l=function(e){function t(){for(var s,n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return(s=e.call.apply(e,[this].concat(t))||this).userInfoBtn=null,s}s(t,e);var r=t.prototype;return r.registerUser=function(){var e=this;return new Promise((function(s,n){c.api.sdk.API.login((function(n,t){e.httpGet("",{code:n||"",anonymousCode:t||"",options:JSON.stringify(c.api.sdk.API.getEnterOptionsSync())},{success:function(e){e.errMsg,s({errmsg:e.errMsg,errno:e.errno,data:{openid:e.openid,sessid:e.sessid}})},fail:function(e){c.manager.ui.showToast("登陆失败"),s({errmsg:"登陆失败",errno:e.errno,data:{openid:"",sessid:""}})}})}))}))},r.loginUser=function(){var e=this;return new Promise((function(s){e.httpGet("",null,{success:function(e){s(e)},fail:function(e){c.manager.ui.showToast("登陆失败")}})}))},r.login=function(){var e=n((function*(){var e=c.lib.storage.get(m),s=null;return"web"==c.api.sdk.getPlatform()?e={openid:"",sessid:""}:e||(e=(s=yield this.registerUser()).data),c.store.user.setUserInfo(e.openid,e.sessid),c.lib.storage.set(m,{openid:e.openid,sessid:e.sessid}),s=yield this.loginUser(),c.manager.servertime.initServerTime(Date.now()),s}));return function(){return e.apply(this,arguments)}}(),r.authorize=function(){var e=this;return new Promise((function(s,t){e.userInfoBtn=c.api.sdk.createUserInfoBtn(n((function*(n){if(n){var t=yield e.onAgreeAuth(n);c.api.sdk.hideUserInfoBtn(),s(t)}else{var r=yield e.onRefuseAuth(n);c.api.sdk.hideUserInfoBtn(),s(r)}})))}))},r.onRefuseAuth=function(e){},r.onShow=function(e){c.api.sdk.onShow(e)},r.onHide=function(e){c.api.sdk.onHide(e)},r.onAgreeAuth=function(){var e=n((function*(e){var s=new d;this.httpGet("",{face:c.store.user.faceUrl,name:c.store.user.userName,sex:0},{success:function(n){c.store.user.auth(e.nickName,e.avatarUrl),c.manager.ui.showToast("授权成功"),s.resolve(n)},fail:function(e){c.manager.ui.showToast("授权失败，请稍后重试"),s.resolve(e)}}),yield s.promise}));return function(s){return e.apply(this,arguments)}}(),r.httpGet=function(e,s,n){"json"!=e.split(".").slice(-1)[0]&&(s=this.packageParams(s,e)),i.isFake?n.success&&n.success({}):o.get(e,s,n)},r.httpPost=function(e,s,n){"json"!=e.split(".").slice(-1)[0]&&(s=this.packageParams(s,e)),i.isFake?n.success&&n.success({}):o.post(e,s,n)},r.packageParams=function(e,s){var n=e||{};if(!i.isFake){n.nonceStr=c.utils.str.rand(28);var t=c.manager.servertime.toServer(),r=JSON.stringify(n);if(h.indexOf(s)<0&&!n._no_safe){var o=c.store.user.userData.lasttime||t,a=t+p+o;r=u.strEncode(r,a),n.c=r}c.store.user.openid&&(n.openid=c.store.user.openid,n.sessid=c.store.user.sessid),n.gameid=f,n.ver=p,n.env=c.api.sdk.envVersion(),n.platform=c.api.sdk.getPlatform(),n.t=t}return n},t}(a))||l);t._RF.pop()}}}));

System.register("chunks:///_virtual/app-manager",["./ApiManager.ts","./DailyManager.ts","./ResManager.ts","./ServerTimeManager.ts","./StorageManager.ts"],(function(){return{setters:[null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/DailyManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseManager.ts","./observer.ts","./app.ts"],(function(e){var t,n,a,i,r,o;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,a=e._decorator},function(e){i=e.default},function(e){r=e.default},function(e){o=e.app}],execute:function(){var s;n._RF.push({},"bd399K35MJDjoeW6xsIpvG2","DailyManager",void 0);var l=a.ccclass,g=(a.property,e("EDailyEvent",{DailyTrigger:0}));e("DailyManager",l("DailyManager")(s=function(e){function n(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).map=new Map,t}t(n,e);var a=n.prototype;return a.onLoad=function(){for(var e=o.data.storage.dailyInfos,t=0;t<e.length;t++){var n=e[t];this.map.set(n.key,n)}},a.onlineDetect=function(e){var t,n=Date.now(),a=(null==(t=this.map.get(e.key))?void 0:t.lastOnLine)||0,i={a:new Date(n),b:new Date(a)};i.a.getDay()!=i.b.getDay()&&i.a.getMonth()!=i.b.getMonth()&&i.a.getFullYear()!=i.b.getFullYear()&&(e.event.emit(g.DailyTrigger),e.lastOnLine=n)},a.createDailyInfo=function(e){return{key:e,event:new r,lastOnLine:0,state:0}},a.getTriggerKey=function(e){return e+"DailyTrigger"},a.onLine=function(e,t){var n=this;this.map.has(e)||this.map.set(e,this.createDailyInfo(e));var a=this.map.get(e);a.event.offAll(),a.event.on(g.DailyTrigger,t,this),o.manager.timer.get(this.getTriggerKey(a.key)).unscheduleAllCallbacks(),o.manager.timer.get(this.getTriggerKey(a.key)).registerDailyTrigger("23:59.59-00.00.01",(function(){n.onlineDetect(a)})),this.onlineDetect(a)},a.changeState=function(e,t){this.map.has(e)&&(this.map.get(e).state=t)},a.getState=function(e){if(this.map.has(e))return this.map.get(e).state},a.offLine=function(e){if(this.map.has(e)){var t=this.map.get(e);t.event.offAll(),o.manager.timer.get(this.getTriggerKey(t.key)).unscheduleAllCallbacks(),t.lastOnLine=Date.now()}},a.onInited=function(){},a.onFinished=function(){},a.init=function(t){e.prototype.init.call(this,t)},n}(i))||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/ResManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseManager.ts","./Config.ts","./Defer2.ts"],(function(e){var n,t,r,a,o,i,s,c,u,p,f;return{setters:[function(e){n=e.inheritsLoose,t=e.asyncToGenerator},function(e){r=e.cclegacy,a=e._decorator,o=e.assetManager,i=e.SpriteFrame,s=e.Prefab,c=e.TextAsset},function(e){u=e.default},function(e){p=e.Config},function(e){f=e.Defer}],execute:function(){var l;r._RF.push({},"51972ZFFl9Mt6LeSWBDr0Kn","ResManager",void 0);var g=a.ccclass;a.property,e("ResManager",g("ResManager")(l=function(e){function r(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(n=e.call.apply(e,[this].concat(r))||this).spriteMap=new Map,n.prefabMap=new Map,n.csvMap=new Map,n}n(r,e);var a=r.prototype;return a.onLoad=function(){},a.onInited=function(){},a.onFinished=function(){},a.init=function(){var n=t((function*(n){var t=this,r=[];o.loadBundle("common",(function(e,n){function a(e,t,a){var o=new f;r.push(o),n.loadDir(e,t,(function(e,n){e?console.error(e):(n.forEach((function(e){a.set(e.name,e)})),o.resolve())}))}a("sprites",i,t.spriteMap),a("prefabs",s,t.prefabMap),a("levels",c,t.csvMap),p.init("configs/config")}));var a=new f;r.push(a),o.loadBundle("uiGame",(function(e,n){a.resolve()})),yield Promise.all(r.map((function(e){return e.promise}))),e.prototype.init.call(this,n)}));return function(e){return n.apply(this,arguments)}}(),a.getSprite=function(e){return this.spriteMap.get(e)},a.getPrefab=function(e){return this.prefabMap.get(e)},a.getLevel=function(e){return this.csvMap.get(e.toString())},r}(u))||l);r._RF.pop()}}}));

System.register("chunks:///_virtual/ServerTimeManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseManager.ts"],(function(n){var e,t,r,i;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,r=n._decorator},function(n){i=n.default}],execute:function(){var o;t._RF.push({},"cace5OQLI5MGLzMQbMWiR3a","ServerTimeManager",void 0);var a=r.ccclass;r.property,n("ServerTimeManager",a("ServerTimeManager")(o=function(n){function t(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))||this).SERVER_TIME=null,e.CLIENT_TIME=Date.now(),e.FIX_TIME=0,e}e(t,n);var r=t.prototype;return r.onLoad=function(){},r.onInited=function(){},r.onFinished=function(){},r.init=function(e){n.prototype.init.call(this,e)},r.initServerTime=function(n){this.SERVER_TIME=n,this.CLIENT_TIME=Date.now(),this.FIX_TIME=this.CLIENT_TIME-this.SERVER_TIME},r.toServer=function(n){return void 0===n&&(n=null),null==n&&(n=Date.now()),n-this.FIX_TIME},r.toClient=function(n){return Number(n)+this.FIX_TIME},r.expire=function(n){return Date.now()<this.toClient(n)?0:1},r.expireClient=function(n){return Date.now()<n?0:1},t}(i))||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/StorageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseManager.ts","./app.ts"],(function(e){var t,a,r,o,n;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,r=e._decorator},function(e){o=e.default},function(e){n=e.app}],execute:function(){var s;a._RF.push({},"9be3e8Md+tNSb5oaC67UbHr","StorageManager",void 0);var i=r.ccclass;r.property,e("StorageManager",i("StorageManager")(s=function(e){function a(){return e.apply(this,arguments)||this}t(a,e);var r=a.prototype;return r.onLoad=function(){this.load()},r.saveUser=function(){n.utils.obj.deepClone(n.store.user)},r.save=function(){var e=n.utils.obj.deepClone(n.data.storage);n.lib.storage.set("storage",e)},r.load=function(){var e=n.lib.storage.get("storage");if(e)for(var t=Object.keys(e),a=0;a<t.length;a++)n.data.storage.hasOwnProperty(t[a])||(n.data.storage[t[a]]=e[t[a]])},a}(o))||s);a._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/app-manager', 'chunks:///_virtual/app-manager'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});